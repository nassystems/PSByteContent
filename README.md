# PSByteContent

PowerShell でバイト列をちょっと便利に扱えれば良いなくらいの軽い気持ちで作った関数群。

実行すると関数を定義する。ソース演算子で (自スコープで) 本スクリプトを実行たのち各種関数を呼び出すのが、想定される使い方。

## 概要

PowerShell では、配列平滑化によりバイト配列が 1 バイトずつの処理に陥りやすいので、これを回避する実装とした。

例えば、

Get-ByteContenct filepath | Select-ByteContent -First 0x100 | Dump-ByteContent

の様に処理したとき、1 バイトずつパイプを渡るのではなく、バイト配列が受け渡しされる。

各コマンドレットの出力でバイト出力する場合の「バイト列」とは、ネストした「バイト配列の配列」を指す。

またバイト入力するコマンドレットの入力型は「バイト配列」で、ネストした「バイト配列の配列」からパイプラインを通じて個々の「バイト配列」を受け取る。

但し、パイプラインの最後の出力がバイト配列× 1 つの場合は、PowerShell の配列平滑化によりネストしない 1 つのバイト配列となることに注意。

## 関数

#### Select-ByteContent

バイト配列から選択したバイト列を出力する。

#### ConvertFrom-ByteContent

バイト配列を HEX 文字列へ変換する。

#### ConvertTo-ByteContent

HEX 文字列をバイト列へ変換する。

#### Open-FileStream

ファイルを開き、ファイルオブジェクトを返す。ファイルオブジェクトは Close-Stream コマンドレットまたはオブジェクトのメソッドで閉じる必要がある。

#### Close-Stream

Open-FileStream で開いたファイルを閉じる。

#### Add-ByteContent

バイト配列をストリームまたはファイルへ追記出力する。

#### Get-ByteContent

ストリームまたはファイルから入力したバイト列を返す。

#### Set-ByteContent

バイト配列をファイルへ出力 (上書き) する。

#### Copy-Stream

ストリームとストリームまたはファイルの間で入出力する。

#### Hash-ByteContent

バイト配列のハッシュ値を計算する。

#### Hash-Stream

ストリーム入力のハッシュ値を計算する。

#### Dump-ByteContent

バイト配列をコンソール向けに出力する。

